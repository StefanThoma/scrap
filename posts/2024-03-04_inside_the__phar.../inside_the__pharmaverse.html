<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Michael Rimler">
<meta name="dcterms.date" content="2024-03-04">
<meta name="description" content="A short blog to help the Pharmaverse community understand how Pharmaverse is governed.">

<title>pharmaverse blog - Inside the pharmaverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../media/pharmaverseblog.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>

      .quarto-title-block .quarto-title-banner {
        background: #eeeeee;
      }
</style>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="pharmaverse blog - Inside the pharmaverse">
<meta property="og:description" content="A short blog to help the Pharmaverse community understand how Pharmaverse is governed.">
<meta property="og:image" content="https://pharmaverse.github.io/blog/posts/2024-03-04_inside_the__phar.../pharmaverse.PNG">
<meta property="og:site-name" content="pharmaverse blog">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">pharmaverse blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pharmaverse/blog" rel="" target=""><i class="bi bi-github" role="img" aria-label="github">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../session_info.html" rel="" target="">
 <span class="menu-text">Session Info</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Inside the pharmaverse</h1>
                  <div>
        <div class="description">
          A short blog to help the Pharmaverse community understand how Pharmaverse is governed.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Community</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Michael Rimler </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#pharmaverse-inception" id="toc-pharmaverse-inception" class="nav-link active" data-scroll-target="#pharmaverse-inception">Pharmaverse Inception</a></li>
  <li><a href="#pharmaverse-objective" id="toc-pharmaverse-objective" class="nav-link" data-scroll-target="#pharmaverse-objective">Pharmaverse Objective</a></li>
  <li><a href="#becoming-a-council-member" id="toc-becoming-a-council-member" class="nav-link" data-scroll-target="#becoming-a-council-member">Becoming a Council Member</a></li>
  <li><a href="#package-inclusion" id="toc-package-inclusion" class="nav-link" data-scroll-target="#package-inclusion">Package Inclusion</a></li>
  <li><a href="#user-adoption" id="toc-user-adoption" class="nav-link" data-scroll-target="#user-adoption">User adoption</a></li>
  <li><a href="#so-what-really-is-pharmaverse" id="toc-so-what-really-is-pharmaverse" class="nav-link" data-scroll-target="#so-what-really-is-pharmaverse">So, what really is pharmaverse?</a></li>
  <li><a href="#thank-you" id="toc-thank-you" class="nav-link" data-scroll-target="#thank-you">Thank you</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<!--------------- typical setup ----------------->
<!--------------- post begins here ----------------->
<p>Greetings, pharmaverse phriends!</p>
<p>Now that the pharmaverse has been around for a few years and seems to be making an impact on clinical reporting (yay!), we wanted to take an opportunity to cast a light on some of the inner workings of pharmaverse and its Council (us). Fortunately, some of you (you know who you are) innovated and created this fantastic channel for <a href="https://pharmaverse.github.io/blog/">pharmaverse blogs</a>. We can’t think of a better way to communicate than by the channel that the pharmaverse community itself created.</p>
<section id="pharmaverse-inception" class="level2">
<h2 class="anchored" data-anchor-id="pharmaverse-inception">Pharmaverse Inception</h2>
<p>The pharmaverse Council was formed in 2020 as a coming together of 4 like-minded individuals embedded in the industry-wide efforts to increase the use of the R language for clinical trial analysis and reporting. These individuals included <a href="https://www.linkedin.com/in/ross-farrugia-820839204/">Ross Farrugia</a> (Roche), <a href="https://www.linkedin.com/in/sumesh-kalappurakal-b8283ab/">Sumesh Kalappurakal</a> (Johnson &amp; Johnson), <a href="https://www.linkedin.com/in/michaelrimler/">Michael Rimler</a> (GSK), and <a href="https://www.linkedin.com/in/michael-s-stackhouse/">Mike Stackhouse</a> (Atorus). Each had historical experience with R adoption, through their primary roles within their respective organizations.</p>
<p>Collectively, these 4 individuals saw the value in</p>
<ol type="i">
<li><p>reducing the choice set of R packages for users,</p></li>
<li><p>identifying gaps in available R packages for delivering the clinical data pipeline, and</p></li>
<li><p>encouraging the development of new packages and/or features to close those gaps.</p></li>
</ol>
<p>The result would be a subset of permissively licensed and open-sourced packages that anyone could use (or modify) to suit their specific use cases, thereby reducing the incidence of organizations privately solving typical problems in isolation. For more background, please refer to the <a href="https://pharmaverse.org/charter/">pharmaverse Charter</a>.</p>
<p>The current pharmaverse Council companies include GSK, Roche, Johnson &amp; Johnson, Atorus, and Novo Nordisk, represented by the original four founders and <a href="https://www.linkedin.com/in/ari-siggaard-knoph-7b852575/">Ari Siggaard Knoph</a> from Novo Nordisk.</p>
<p>In March 2023, the <a href="https://phuse.global/">PHUSE</a> Board of Directors approached the pharmaverse Council with a proposal offering support to pharmaverse developers and leadership to advance the pharmaverse mission. The PHUSE proposal aligned with its mission to promote “[s]haring ideas, tools and standards around data, statistical and reporting technologies to advance the future of life sciences.” PHUSE is currently a supporter of the pharmaverse and its objectives, evident through activities such as:</p>
<ul>
<li><p>the provision of access to PHUSE’s communication and file-sharing platforms to package teams,</p></li>
<li><p>the provision of project management support to package teams (if needed),</p></li>
<li><p>enablement and promotion of pharmaverse innovations and activities, and</p></li>
<li><p>enablement of face-to-face community connections at PHUSE events.</p></li>
</ul>
</section>
<section id="pharmaverse-objective" class="level2">
<h2 class="anchored" data-anchor-id="pharmaverse-objective">Pharmaverse Objective</h2>
<p>Pharmaverse aims to promote the collaborative development of curated open-source R packages for clinical reporting in pharma. Indirectly, we also strive to encourage and increase R adoption within the industry and facilitate communication and collaboration among both R users and R developers.</p>
</section>
<section id="becoming-a-council-member" class="level2">
<h2 class="anchored" data-anchor-id="becoming-a-council-member">Becoming a Council Member</h2>
<p>Membership to the <strong>pharmaverse Council</strong> is granted to the organization and is open to any type of organization (requirements further described <a href="https://pharmaverse.org/contribute/council/">here</a>). In layperson’s terms, the Council member organization must support a representative on the council and demonstrate a commitment to contributions to the pharmaverse codebase. Specifically, <em>“Commitment to at least 2 open source packages under pharmaverse via reviews, hands-on code development, product leads, or other roles which contribute to the design, development, testing, release, and/or maintenance.”</em> If any representative steps away from their council position, the member organization would identify the replacement. Council meeting minutes are published in the pharmaverse GitHub <a href="https://github.com/pharmaverse/pharmaverse/tree/main/static/council%20meeting%20minutes">here</a>.</p>
</section>
<section id="package-inclusion" class="level2">
<h2 class="anchored" data-anchor-id="package-inclusion">Package Inclusion</h2>
<p>Applications for a package to be included in the pharmaverse may originate from anybody and anywhere. The Council (through its <a href="https://pharmaverse.org/contribute/wg/">Working Groups</a>) reviews applications and either (i) approves the package into the pharmaverse or (ii) rejects the package with a rationale. When a rejection has been issued, common reasons have been ‘not now’ with feedback to enhance testing, documentation, or other aspects that enrich the package. Working Groups may also steer the applicant to other packages with similar functionality. In this sense, respective package maintainers (product owners) are encouraged to work collaboratively to reduce duplicated features across packages and improve the overall experience of the user base. The Council and Working Groups are tasked with assessing this aspect of the pharmaverse code base, but the decision on implementation ultimately resides with the individual package maintainers.</p>
<p>Package reviews are conducted in the open:</p>
<ul>
<li><p><strong>Example 1:</strong> {riskassessment} from R Validation Hub working group – result successful: <a href="https://github.com/pharmaverse/pharmaverse/issues/195" class="uri">https://github.com/pharmaverse/pharmaverse/issues/195</a></p></li>
<li><p><strong>Example 2:</strong> {rhino} from Appsilon – result successful: <a href="https://github.com/pharmaverse/pharmaverse/issues/260" class="uri">https://github.com/pharmaverse/pharmaverse/issues/260</a></p></li>
<li><p><strong>Example 3:</strong> {synthetic.cdisc.data} from Roche – result unsuccessful: <a href="https://github.com/pharmaverse/pharmaverse/issues/235" class="uri">https://github.com/pharmaverse/pharmaverse/issues/235</a></p></li>
</ul>
<p>At the time of publication, there were over 250 contributors to pharmaverse packages, across a network of organizations much broader than just the 5 Council member organizations. pharmaverse Council encourages diversity of individual contributors and the organizations they are affiliated with. The decision on product development team rosters is the sole discretion of the packages. Of course, Council member organizations are providing people to support the pharmaverse ecosystem (e.g., developers and product owners). However, both strategic and operational decisions on the development and maintenance of individual packages reside outside the pharmaverse Council.</p>
</section>
<section id="user-adoption" class="level2">
<h2 class="anchored" data-anchor-id="user-adoption">User adoption</h2>
<p>Pharma companies are free to choose any selection of R packages for clinical reporting and only they can justify their choices. The <a href="https://pharmaverse.org/">pharmaverse website</a> states that “[a]nyone is free to choose any selection of pharmaverse recommended software or those from any other source.” In addition, pharmaverse does not seek to engage or get endorsement from any health authority. We are merely trying to provide a public service to help individuals and organizations involved in clinical reporting navigate a vast field of available R packages licensed as open source.</p>
<p>The pharmaverse website provides illustrative <a href="https://pharmaverse.github.io/examples/">examples</a> of how to use pharmaverse and other packages to build common deliverables.</p>
</section>
<section id="so-what-really-is-pharmaverse" class="level2">
<h2 class="anchored" data-anchor-id="so-what-really-is-pharmaverse">So, what really is pharmaverse?</h2>
<p>Pharmaverse is essentially two things:</p>
<ol type="1">
<li><p>Pharmaverse is a list of packages curated by the pharmaverse Council and Working Groups, primarily communicated via the pharmaverse website. Pharmaverse also maintains an <a href="https://pharmaverse.r-universe.dev/builds">R-universe build</a> for ease of use outside GxP settings.</p></li>
<li><p>pharmaverse is a community of R users and R developers “working to promote collaborative development of curated open-source R packages for clinical reporting usage in pharma.”</p></li>
</ol>
<p>Pharmaverse Council provides a <a href="https://pharmaverse.slack.com/">Slack workspace</a> to build community amongst all interested parties and serve as a communication platform for individuals and package teams. At present, membership to this workspace exceeds &gt;1200 members.</p>
<p>Pharmaverse Council also provides a <a href="https://github.com/pharmaverse">GitHub organization</a> for developers to work in, but hosting packages in the pharmaverse GitHub is not required to be part of pharmaverse.</p>
<p>These elements are supported on an all-volunteer basis, mostly with community versions of various platforms (e.g., we use the free tier on Slack).</p>
</section>
<section id="thank-you" class="level2">
<h2 class="anchored" data-anchor-id="thank-you">Thank you</h2>
<p>Thank you, each of you, for the part that you play. No matter how big or small, you are helping amplify the impact that open collaboration is having on how we deliver new medicines and vaccines to patients around the world. We hope you are finding, and continue to find, pharmaverse a valuable piece of the clinical reporting puzzle.</p>
<p>And, if not – let us know!</p>
<p><em>Pharmaverse Council – Ari, Michael, Mike, Ross, and Sumesh</em></p>
<p><strong>Disclaimer:</strong> This blog contains opinions that are of the authors alone and do not necessarily reflect the strategy of their respective organizations.</p>
<!--------------- appendices go here ----------------->
</section>
<div class="cell">
<div class="cell-output-display">


</div>
</div>



<div id="quarto-appendix" class="default"><section id="last-updated" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Last updated</h2><div class="quarto-appendix-contents">

<p>2024-05-02 14:33:09.942875</p>
</div></section><section id="details" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Details</h2><div class="quarto-appendix-contents">

<p><a href="https://github.com/pharmaverse/blog/tree/main/posts/2024-03-04_inside_the__phar.../code_sections.qmd">source code</a>, <a href="https://github.com/pharmaverse/blog/tree/main/posts/2024-03-04_inside_the__phar.../renv.lock">R environment</a></p>
</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{rimler2024,
  author = {Rimler, Michael},
  title = {Inside the Pharmaverse},
  date = {2024-03-04},
  url = {https://pharmaverse.github.io/blog/posts/2024-03-04_inside_the__phar.../inside_the__pharmaverse.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-rimler2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Rimler, Michael. 2024. <span>“Inside the Pharmaverse.”</span> March 4,
2024. <a href="https://pharmaverse.github.io/blog/posts/2024-03-04_inside_the__phar.../inside_the__pharmaverse.html">https://pharmaverse.github.io/blog/posts/2024-03-04_inside_the__phar.../inside_the__pharmaverse.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>